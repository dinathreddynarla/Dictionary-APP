<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dictionary and Thesaurus</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- <link rel="stylesheet" href="style.css"> -->
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #e1f5fe;
            color: #333;
            padding: 2rem;
            max-width: 80%;
            margin: auto;
            border-radius: 0.5rem;
            box-shadow: 0 0.25rem 1.25rem rgba(0, 0, 0, 0.2);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 3rem;
            color: #ff6f00;
        }
        
        #search {
            display: flex;
            gap: 0.5rem;
        }
        
        label {
            font-weight: bold;
            text-align: center;
            width: 25%;
            font-size: 1.5rem;
            color: #3f51b5;
        }
        
        input[type="text"] {
            width: calc(100% - 10rem);
            padding: 1rem;
            border: 0.2rem solid #ff6f00;
            border-radius: 0.3rem;
            font-size: 1rem;
            box-shadow: 0 0.125rem 0.3125rem rgba(0, 0, 0, 0.2);
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        
        input[type="text"]:focus {
            border-color: #3f51b5;
            box-shadow: 0 0 0.5rem rgba(63, 81, 181, 0.6);
        }
        
        button {
            padding: 1rem 1.5rem;
            background-color: #ff6f00;
            color: white;
            border: none;
            border-radius: 0.3rem;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 0.25rem 0.625rem rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s, transform 0.2s;
        }
        
        button:hover {
            background-color: #ff8f00;
            transform: translateY(-0.125rem);
        }
        
        #suggestions {
            margin-top: 2rem;
            border-radius: 0.625rem;
            box-shadow: 0 0.125rem 0.5rem rgba(0, 0, 0, 0.2);
            transition: transform 0.2s;
        }
        
        #suggestions div:hover {
            transform: scale(1.03);
        }
        
        #suggestions div {
            padding: 1.25rem;
            margin: 0.5rem 0;
            cursor: pointer;
            border-radius: 0.3rem;
            font-size: 1.1rem;
            font-weight: 600;
            transition: background-color 0.3s, transform 0.2s;
        }
        
        #suggestions div:nth-child(n) {
            background-color: #ffd740;
        }
        
        #suggestions div:nth-child(2n) {
            background-color: #ffab91;
        }
        
        #suggestions div:nth-child(3n) {
            background-color: #80deea;
        }
        
        #suggestions div:hover {
            opacity: 0.8;
            transform: scale(1.02);
        }
        
        .images {
            display: flex;
            flex-wrap: wrap;
            margin-top: 2rem;
            justify-content: center;
        }
        
        .images img {
            width: 20vw;
            height: auto;
            margin: 0.5rem;
            border-radius: 0.3rem;
            box-shadow: 0 0.25rem 0.625rem rgba(0, 0, 0, 0.2);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .images img:hover {
            transform: scale(1.05);
            box-shadow: 0 0.375rem 0.75rem rgba(0, 0, 0, 0.3);
        }
        
        .synonyms, .antonyms {
            margin-top: 1rem;
            background-color: #e1bee7;
            padding: 1rem;
            border-radius: 0.3rem;
            font-size: 1.1rem;
            border-left: 0.5rem solid #ff6f00;
        }
        
        .synonyms h2, .antonyms h2 {
            text-transform: uppercase;
            margin: 0 0 0.625rem 0;
            color: #3f51b5;
        }
        
        .main-word-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .main-word {
            font-size: 1.5rem;
            font-weight: bold;
            text-transform: uppercase;
            color: #d50000;
        }
        
        .speaker-icon {
            cursor: pointer;
            color: #3f51b5;
            transition: color 0.3s;
        }
        
        .speaker-icon:hover {
            color: #ff6f00;
        }
        
        .phonetic {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #e0f7fa;
            border: 0.2rem solid #00bcd4;
            border-radius: 0.3rem;
            font-style: italic;
            font-size: 1.125rem;
            color: #00796b;
            text-align: center;
        }
        
        .definition, .part-of-speech, .example {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #c8e6c9;
            border-radius: 0.3rem;
            font-size: 1.1rem;
            border-left: 0.5rem solid #ff6f00;
        }
        
        .definition {
            font-style: italic;
        }
        
        .part-of-speech {
            font-weight: bold;
        }
        
        p {
            color: red;
            font-weight: bold;
            margin-top: 1rem;
            font-size: 1.5rem;
            text-align: center;
        }
        /* Loading Spinner Styles */
.spinner {
    border: 8px solid #f3f3f3; /* Light gray */
    border-top: 8px solid #3498db; /* Blue */
    border-radius: 50%;
    width: 60px;
    height: 60px;
    animation: spin 2s linear infinite;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1000; /* Ensure it's on top of other elements */
  }
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  /* Slide-In Animation */
  .main-word-section, .phonetic, .part-of-speech, .definition, .example, .synonyms, .antonyms, .images {
      opacity: 0; /* Initially hidden */
      transform: translateX(-50px); /* Start from left */
      transition: all 0.5s ease-in-out; /* Smooth transition */
  }
  
  .show-content {
      opacity: 1; /* Fully visible */
      transform: translateX(0); /* End position */
  }
  
        
        @media screen and (max-width: 720px) {
            body {
                padding: 1.5rem;
            }
        
            h1 {
                font-size: 2.5rem;
            }
        
            label {
                width: 30%;
                font-size: 1.25rem;
            }
            
            input[type="text"], button {
                font-size: 0.9rem;
            }
        
            #search {
                flex-direction: column;
                align-items: stretch;
                width: 96%;
            }
        
            input[type="text"] {
                width: 96%;
            }
        
            .images img {
                width: 30vw;
            }
        
            .main-word {
                font-size: 1.25rem;
            }
        }
        
        @media screen and (max-width: 480px) {
            body {
                padding: 1rem;
            }
        
            h1 {
                font-size: 2rem;
            }
        
            label {
                width: 40%;
                font-size: 1rem;
            }
        
            input[type="text"], button {
                font-size: 0.8rem;
            }
        
            #search {
                flex-direction: column;
                align-items: stretch;
                width: 96%;
            }
        
            input[type="text"] {
                width: 96%;
            }
        
            .images img {
                width: 40vw;
            }
        
            .main-word {
                font-size: 1.1rem;
            }
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            color: white; /* Text color */
        }

        .header h1 {
            margin: 0;
            font-size: 1.5em; /* Title font size */
        }

        .header button {
            background-color: #ff4d4d; /* Logout button color */
            color: white; /* Button text color */
            border: none;
            padding: 10px 15px;
            border-radius: 5px; /* Button rounded corners */
            cursor: pointer; /* Pointer on hover */
            font-size: 1em; /* Button font size */
        }

        .header button:hover {
            background-color: #ff1a1a; /* Button hover color */
        }
        
    </style>
</head>
<body>   
    <div class="header">
        <h1 id="user">Welcome, User!</h1>
        <button id="logout">Logout</button>
    </div>
    <h1>Dictionary</h1>
    <div id="search">
        <label for="inp-word">Enter a word:</label>
            <input type="text" id="inp-word" placeholder="Type here..." autocomplete="off">
            <button id="search-btn"> <i class="fas fa-search"></i></button>
    </div>
    <div id="suggestions"></div>
    <div id="result"></div>
    <div class="spinner" id="loadingSpinner" style="display: none;"></div>

    <audio id="sound"></audio>
    <script type="module">

        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
        import { getFirestore,doc,getDoc} from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";
        import { getAuth,onAuthStateChanged,signOut} from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";
        
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyDk-jY4LDcRw4or4A42BmH0_kbyOqQ3-Cc",
          authDomain: "authentication-app-6cf14.firebaseapp.com",
          databaseURL: "https://authentication-app-6cf14-default-rtdb.firebaseio.com",
          projectId: "authentication-app-6cf14",
          storageBucket: "authentication-app-6cf14.appspot.com",
          messagingSenderId: "169600919766",
          appId: "1:169600919766:web:742372a38728c7a5c0c177"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth();
        let username = document.getElementById("user")
        //author state
        const user = auth.currentUser;
        onAuthStateChanged(auth, (user) => {
            if (user) {
                getDoc(doc(db,"users",user.uid)).then(docSnap => {
                   if(docSnap.exists()){
                        let userdata =docSnap.data()
                       console.log(userdata)
                       username.innerText=`Welcome, ${userdata.fullName}`
                   }else{
                       console.log("no data")
                   }
           })
              // ...
            } else {
              // User is signed out
              window.open("authentication.html","_self");
            }
          });
        let logout = document.getElementById("logout")
        logout.addEventListener("click",(e)=>{
            signOut(auth).then(() => {
                window.open("authentication.html","_self");
                // Sign-out successful.
              }).catch((error) => {
                // An error happened.
                const errorCode = error.code;
                const errorMessage = error.message;
                alert(errorMessage)
              });
        })
        
      </script>
    <script> 
        const searchBtn = document.getElementById('search-btn');
        const suggestionsDiv = document.getElementById("suggestions");
        const result = document.getElementById("result");
        const sound = document.getElementById("sound");

        const clearSuggestions = () => suggestionsDiv.innerHTML = '';
        const clearResult = () => result.innerHTML = '';

        const handleSearch = async (word) => {
            if (!word) return;

            clearSuggestions();
            clearResult();
            loadingSpinner.style.display = 'block';

            try {
                const dictionaryResponse = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
                const dictionaryData = await dictionaryResponse.json();
                console.log(dictionaryData);
                loadingSpinner.style.display = 'none';
                let main = document.createElement("div");
                main.className = "main-word-section";
                main.innerHTML = `<div class="main-word"><strong>${word}</strong></div>`;
                let audioEntry = dictionaryData[0].phonetics.find(p => p.audio);
                let audioUrl = audioEntry?.audio || "";
                if (audioUrl) {
                    main.innerHTML += `<button onclick="playSound()">
                        <i class="fas fa-volume-up speaker-icon"></i>
                    </button>`;
                    sound.setAttribute("src", audioUrl);
                }
                result.appendChild(main);
               setTimeout(() => main.classList.add('show-content'), 150);


                let phoneticEntry = dictionaryData[0].phonetics.find(p => p.text);
                let phonetic = phoneticEntry?.text || "";
                if (phonetic) {
                    let phoneticDiv = document.createElement("div");
                    phoneticDiv.className = "phonetic";
                    phoneticDiv.innerHTML = `<strong>Phonetic:</strong> ${phonetic}`;
                    result.appendChild(phoneticDiv);
                    setTimeout(() => phoneticDiv.classList.add('show-content'), 300); // 200ms delay
                }

                const partOfSpeechList = dictionaryData[0].meanings.map(meaning => meaning.partOfSpeech);
                let partOfSpeechDiv = document.createElement("div");
                partOfSpeechDiv.className = "part-of-speech";
                partOfSpeechDiv.innerHTML = `<strong>Part of Speech:</strong> ${partOfSpeechList.join(', ')}`;
                result.appendChild(partOfSpeechDiv);
                setTimeout(() => partOfSpeechDiv.classList.add('show-content'), 450); // 300ms delay


                let definition = dictionaryData[0].meanings.find(m => m.definitions[0].definition)?.definitions[0].definition || "";
                if (definition) {
                    let definitionDiv = document.createElement("div");
                    definitionDiv.className = "definition";
                    definitionDiv.innerHTML = `<strong>Definition:</strong> ${definition}`;
                    result.appendChild(definitionDiv);
                    setTimeout(() => definitionDiv.classList.add('show-content'), 600); // 400ms delay
                }
                let example = findExampleWithWord(dictionaryData[0].meanings, word) || dictionaryData[0].meanings.find(m => m.definitions.find(d => d.example))?.definitions[0].example || "";
                if (example) {
                    let exampleDiv = document.createElement("div");
                    exampleDiv.className = "example";
                    exampleDiv.innerHTML = `<strong>Example:</strong> ${example}`;
                    result.appendChild(exampleDiv);
                    setTimeout(() => exampleDiv.classList.add('show-content'), 750); // 500ms delay
                }

                // Fetch synonyms and antonyms
                const thesaurusApiUrl = "https://thesaurus-by-api-ninjas.p.rapidapi.com/v1/thesaurus?word=";
                const thesaurusOptions = {
                    method: 'GET',
                    headers: {
                        'x-rapidapi-key': '172be0fd3dmshd8f189ff539b4d7p1ea48bjsn2d27fa8a4e9c',
                        'x-rapidapi-host': 'thesaurus-by-api-ninjas.p.rapidapi.com'
             }
                };
                const thesaurusResponse = await fetch(`${thesaurusApiUrl}${word}`, thesaurusOptions);
                const thesaurusData = await thesaurusResponse.json();
                let synonyms = thesaurusData.synonyms.slice(0, 10);
                let antonyms = thesaurusData.antonyms.slice(0, 10);
                console.log(antonyms)
                console.log(synonyms)
                if (synonyms.length > 1){
                    
                    let synonymsDiv = document.createElement("div");
                    synonymsDiv.className = "synonyms";
                    synonymsDiv.innerHTML = `<strong>Synonyms:</strong> ${synonyms.join(', ')}`;
                    result.appendChild(synonymsDiv);
                    setTimeout(() => { synonymsDiv.classList.add('show-content'); // Add animation class here
                    });
                }
                if (antonyms.length > 1){
                    
                    let antonymsDiv = document.createElement("div");
                    antonymsDiv.className = "antonyms";
                    antonymsDiv.innerHTML = `<strong>antonyms:</strong> ${antonyms.join(', ')}`;
                    result.appendChild(antonymsDiv);
                    setTimeout(() => {antonymsDiv.classList.add('show-content'); // Add animation class here
                    });
                }
                
                const imageResponse = await fetch(`https://api.unsplash.com/search/photos?query=${word}&client_id=nqqN5PrwcgdzEng3auwnBrYtZrzfFv7lSFFmyDMnBCE&per_page=12`);
                const imageData = await imageResponse.json();
                const images = imageData.results;

                if (images.length) {
                    let imagesHtml = '<div class="images">';
                    images.forEach(image => {
                        imagesHtml += `<img src="${image.urls.small}" alt="${word} image">`;
                    });
                    imagesHtml += '</div>';
                    result.innerHTML += imagesHtml;
                    setTimeout(() => document.querySelector('.images').classList.add('show-content'), 1000); 
                } else {
                    result.innerHTML += `<p class="error">No images found for "${word}".</p>`;
                }

            }catch (err) {
                result.innerHTML = "<p>Couldn't find the word</p>"
                console.error("Error fetching dictionary data:", err);
                loadingSpinner.style.display = 'none';
            }
        };

        document.getElementById("inp-word").addEventListener("input", async () => {
            const inpWord = document.getElementById("inp-word").value;
            if (inpWord.length < 2) {
                return clearSuggestions();
            }

            try {
                const response = await fetch(`https://api.datamuse.com/sug?s=${inpWord}`);
                const data = await response.json();
                clearSuggestions();

                data.forEach(suggestion => {
                    const suggestionDiv = document.createElement('div');
                    suggestionDiv.textContent = suggestion.word;
                    suggestionDiv.addEventListener('click', async () => {
                        document.getElementById("inp-word").value = suggestion.word;
                        clearSuggestions();
                        await handleSearch(suggestion.word);
                    });
                    suggestionsDiv.appendChild(suggestionDiv);
                });
            } catch (err) {
                console.error("Error fetching suggestions:", err);
            }
        });

        searchBtn.addEventListener("click", async () => {
            const word = document.getElementById("inp-word").value;
            await handleSearch(word);
        });

        const playSound = () => {
            if (sound.src) {
                sound.play();
            }
        };

        function findExampleWithWord(meanings, word) {
            for (let meaning of meanings) {
                for (let definition of meaning.definitions) {
                    if (definition.example && definition.example.includes(word)) {
                        return definition.example;
                    }
                }
            }
            return null;
        }
   

    </script>
        
</body>
</html>
